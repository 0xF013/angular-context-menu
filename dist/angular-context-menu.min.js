angular.module("ng-context-menu",[]).factory("ngContextMenu",["$q","$http","$compile","$templateCache","$animate","$rootScope","$controller",function(e,t,n,o,r,a,c){return function(l){function i(e,t){return g&&e&&p(e),s.then(function(n){return h||u(n,e),t&&h.css(t),h})}function u(e,t){if(h=angular.element(e),0===h.length)throw new Error("The template contains no elements; you need to wrap text nodes");r.enter(h,$),g=a.$new(),t&&p(t);var o=c(d,{$scope:g});v&&(g[v]=o),n(h)(g)}function p(e){for(var t in e)g[t]=e[t]}function f(){var t=e.defer();return h?r.leave(h,function(){g.$destroy(),h=null,t.resolve()}):t.resolve(),t.promise}function m(){return!!h}if(!(!l.template^!l.templateUrl))throw new Error("Expected context menu to have exacly one of either `template` or `templateUrl`");var s,g,d=(l.template,l.controller||angular.noop),v=l.controllerAs,$=angular.element(l.container||document.body),h=null;if(l.template){var x=e.defer();x.resolve(l.template),s=x.promise}else s=t.get(l.templateUrl,{cache:o}).then(function(e){return e.data});return{open:i,close:f,active:m}}}]).directive("hasContextMenu",["$injector","$window","$parse",function(e,t){return{restrict:"A",link:function(n,o,r){function a(e){p.open(f,l(e))}function c(){p.close()}function l(e){return{top:Math.max(e.pageY,0)+"px",left:Math.max(e.pageX,0)+"px"}}function i(e){p.active()&&u&&2!==e.button&&n.$apply(function(){c()})}var u,p=e.get(r.target),f={},m=angular.element(t),s=r.triggerOnEvent||"contextmenu",g=r.locals.split(",").map(function(e){return e.trim()});angular.forEach(g,function(e){f[e]=n[e]}),o.bind(s,function(e){u=e.target,e.preventDefault(),e.stopPropagation(),n.$apply(function(){a(e)})}),m.bind("keyup",function(e){p.active()&&27===e.keyCode&&n.$apply(function(){c()})}),m.bind("click",i),m.bind(s,i)}}}]);