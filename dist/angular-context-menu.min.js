angular.module("ng-context-menu",[]).service("ContextMenuService",[function(){var e={},n={opened:!1,targetMenu:null,context:{}};return{open:function(t){n.targetMenu=t,n.opened=!0,e[t].addClass("opened")},close:function(){n.targetMenu=null,n.opened=!1,n.context={},angular.forEach(e,function(e){e.removeClass("opened")})},opened:function(){return n.opened},registerMenuElement:function(n,t){e[n]=t},getMenuElement:function(n){return e[n]},setContext:function(e){n.context=e},getContextMenu:function(){return n},getCurrentTaget:function(){return n.targetMenu}}}]).directive("hasContextMenu",["$window","$parse","ContextMenuService",function(e,n,t){return{restrict:"A",link:function(o,u,r){function c(e){p.css("top",Math.max(e.pageY,0)+"px"),p.css("left",Math.max(e.pageX,0)+"px"),t.open(s)}function a(){t.close(s)}function i(e){g||!t.opened()||2===e.button&&e.target===l||o.$apply(function(){a()})}var l,p,g=o.$eval(r.contextMenuDisabled),f=angular.element(e),d=n(r.contextMenu),s=r.target,x=r.triggerOnEvent||"contextmenu",M=n(r.processEvent)(o)||angular.noop;u.bind(x,function(e){g||(p=t.getMenuElement(s),p||(p=angular.element(document.getElementById(s)),t.registerMenuElement(s,p)),l=e.target,e.preventDefault(),e.stopPropagation(),o.$apply(function(){t.setContext(o),d(o,{$event:e}),M(e),c(e)}))}),f.bind("keyup",function(e){!g&&t.opened()&&27===e.keyCode&&o.$apply(function(){a()})}),f.bind("click",i),f.bind(x,i)}}}]);