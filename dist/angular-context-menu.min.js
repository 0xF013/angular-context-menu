angular.module("ng-context-menu",[]).factory("ngContextMenu",["$q","$http","$compile","$templateCache","$animate","$rootScope","$controller",function(e,t,n,o,r,a,c){return function(l){function i(e,t){return g&&t&&p(t),s.then(function(n){h||u(n,t),h.css("top",Math.max(e.y,0)+"px"),h.css("left",Math.max(e.x,0)+"px")})}function u(e,t){if(h=angular.element(e),0===h.length)throw new Error("The template contains no elements; you need to wrap text nodes");r.enter(h,$),g=a.$new(),t&&p(t);var o=c(d,{$scope:g});v&&(g[v]=o),n(h)(g)}function p(e){for(var t in e)g[t]=e[t]}function f(){var t=e.defer();return h?r.leave(h,function(){g.$destroy(),h=null,t.resolve()}):t.resolve(),t.promise}function m(){return!!h}if(!(!l.template^!l.templateUrl))throw new Error("Expected context menu to have exacly one of either `template` or `templateUrl`");var s,g,d=(l.template,l.controller||angular.noop),v=l.controllerAs,$=angular.element(l.container||document.body),h=null;if(l.template){var x=e.defer();x.resolve(l.template),s=x.promise}else s=t.get(l.templateUrl,{cache:o}).then(function(e){return e.data});return{open:i,close:f,active:m}}}]).directive("hasContextMenu",["$injector","$window","$parse",function(e,t){return{restrict:"A",link:function(n,o,r){function a(e){u.open({x:e.pageX,y:e.pageY},p)}function c(){u.close()}function l(e){u.active()&&i&&2!==e.button&&n.$apply(function(){c()})}var i,u=e.get(r.target),p={},f=angular.element(t),m=r.triggerOnEvent||"contextmenu",s=r.locals.split(",").map(function(e){return e.trim()});angular.forEach(s,function(e){p[e]=n[e]}),o.bind(m,function(e){i=e.target,e.preventDefault(),e.stopPropagation(),n.$apply(function(){a(e)})}),f.bind("keyup",function(e){u.active()&&27===e.keyCode&&n.$apply(function(){c()})}),f.bind("click",l),f.bind(m,l)}}}]);