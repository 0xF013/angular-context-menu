angular.module("ng-context-menu",[]).service("ContextMenuService",[function(){var e,n={opened:!1,context:{}};return{open:function(){n.opened=!0,e.addClass("opened")},close:function(){n.opened=!1,n.context={},e.removeClass("opened")},opened:function(){return n.opened},setContext:function(e){n.context=e},getContextMenu:function(){return n},getTarget:function(){return e},setTarget:function(n){e=n}}}]).directive("contextMenu",["$window","$parse","ContextMenuService",function(e,n,t){return{restrict:"A",link:function(o,u,c){function a(e,n){n.css("top",Math.max(e.pageY,0)+"px"),n.css("left",Math.max(e.pageX,0)+"px"),t.open()}function i(){t.close()}function r(e){l||!t.opened()||2===e.button&&e.target===p||o.$apply(function(){i(f)})}var p,l=o.$eval(c.contextMenuDisabled),d=angular.element(e),f=null,g=n(c.contextMenu);u.bind("contextmenu",function(e){l||(null===f&&(f=c.target?angular.element(document.getElementById(c.target)):t.getTarget()),t.setTarget(f),p=e.target,e.preventDefault(),e.stopPropagation(),o.$apply(function(){t.setContext(o),g(o,{$event:e}),a(e,f)}))}),d.bind("keyup",function(e){!l&&t.opened()&&27===e.keyCode&&o.$apply(function(){i(f)})}),d.bind("click",r),d.bind("contextmenu",r)}}}]);