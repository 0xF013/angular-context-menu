angular.module("ng-context-menu",[]).service("ContextMenuService",[function(){var e,n={opened:!1,context:{}};return{open:function(){n.opened=!0,e.addClass("opened")},close:function(){n.opened=!1,n.context={},e.removeClass("opened")},opened:function(){return n.opened},setContext:function(e){n.context=e},getContextMenu:function(){return n},getTarget:function(){return e},setTarget:function(n){e=n}}}]).directive("hasContextMenu",["$window","$parse","ContextMenuService",function(e,n,t){return{restrict:"A",link:function(o,u,c){function a(e,n){n.css("top",Math.max(e.pageY,0)+"px"),n.css("left",Math.max(e.pageX,0)+"px"),t.open()}function r(){t.close()}function i(e){l||!t.opened()||2===e.button&&e.target===p||o.$apply(function(){r(g)})}var p,l=o.$eval(c.contextMenuDisabled),d=angular.element(e),g=null,s=n(c.contextMenu),f=c.triggerOnEvent||"contextmenu",x=n(c.processEvent)(o)||angular.noop;u.bind(f,function(e){l||(null===g&&(g=c.target?angular.element(document.getElementById(c.target)):t.getTarget()),t.setTarget(g),p=e.target,e.preventDefault(),e.stopPropagation(),o.$apply(function(){t.setContext(o),s(o,{$event:e}),x(e),a(e,g)}))}),d.bind("keyup",function(e){!l&&t.opened()&&27===e.keyCode&&o.$apply(function(){r(g)})}),d.bind("click",i),d.bind(f,i)}}}]);