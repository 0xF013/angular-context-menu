angular.module("ng-context-menu",[]).service("ContextMenuService",[function(){var e,n={opened:!1,context:{}};return{open:function(){n.opened=!0,e.addClass("opened")},close:function(){n.opened=!1,n.context={},e.removeClass("opened")},opened:function(){return n.opened},setContext:function(e){n.context=e},getContextMenu:function(){return n},getTarget:function(){return e},setTarget:function(n){e=n}}}]).directive("contextMenu",["$window","$parse","ContextMenuService",function(e,n,t){return{restrict:"A",link:function(o,u,c){function a(e,n){n.css("top",Math.max(e.pageY,0)+"px"),n.css("left",Math.max(e.pageX,0)+"px"),t.open()}function r(){t.close()}function i(e){l||!t.opened()||2===e.button&&e.target===p||o.$apply(function(){r(s)})}var p,l=o.$eval(c.contextMenuDisabled),d=angular.element(e),s=null,f=n(c.contextMenu),g=n(c.processEvent)(o)||angular.noop;u.bind("contextmenu",function(e){l||(null===s&&(s=c.target?angular.element(document.getElementById(c.target)):t.getTarget()),t.setTarget(s),p=e.target,e.preventDefault(),e.stopPropagation(),o.$apply(function(){t.setContext(o),f(o,{$event:e}),g(e),a(e,s)}))}),d.bind("keyup",function(e){!l&&t.opened()&&27===e.keyCode&&o.$apply(function(){r(s)})}),d.bind("click",i),d.bind("contextmenu",i)}}}]);